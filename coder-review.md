
## Code Review

### Новые файлы

   * `src/Infrastructure/ConnectorBuilder.php`: Добавлен новый класс-строитель для создания экземпляра
     Connector.

### Удаленные файлы

   * `src/Infrastructure/ConnectorFacade.php`: Удален, так как его функциональность была заменена на
     ConnectorBuilder и прямое использование Connector.

### Измененные файлы

   * `src/Controller/AddToCartController.php`:
       * Теперь для получения корзины используется session_id().
       * Если корзины не существует, создается новая с привязкой к пользователю.
       * В CartItem теперь передается объект Product, а не его UUID и цена.
       * После добавления товара корзина сохраняется.


   * `src/Controller/GetCartController.php`:
       * Для получения корзины теперь используется session_id().
       * Возвращает статус 404, если корзина не найдена, и 200, если найдена.
       * Добавлен приватный метод createResponse для уменьшения дублирования кода.


   * `src/Domain/Cart.php`:
       * Метод addItem теперь проверяет, существует ли уже товар в корзине. Если да, то увеличивает его
         количество, если нет — добавляет новый.


   * `src/Domain/CartItem.php`:
       * Свойства сделаны приватными.
       * Теперь класс хранит объект Product, а не productUuid и price, чтобы избежать проблемы N+1.
       * Добавлен метод addQuantity для обновления количества товара.
       * Метод getPrice теперь вычисляет общую стоимость для данного товара (цена продукта * количество).

   * `src/Infrastructure/Connector.php`:
       * Метод get теперь принимает ключ типа string вместо объекта Cart.
       * Метод set теперь принимает параметр ttl.
       * Конструктор теперь использует property promotion.


   * `src/Infrastructure/ConnectorException.php`:
       * Пользовательская реализация исключения была заменена простым классом, который наследует \Exception.


   * `src/Repository/CartManager.php`:
       * Класс больше не наследует ConnectorFacade. Теперь он использует композицию, и Connector внедряется
         через конструктор.
       * LoggerInterface также внедряется через конструктор.
       * Метод saveCart теперь принимает sessionId и объект Cart.
       * Метод getCart теперь принимает sessionId и возвращает null, если корзина не найдена.


   * `src/Repository/ProductRepository.php`:
       * Исправлена уязвимость к SQL-инъекциям за счет использования подготовленных выражений.
       * Метод getByCategory теперь выбирает все столбцы из таблицы products.
       * Метод make был переименован в createFromRow и сделан приватным.


   * `src/View/CartView.php`:
       * Убрана инъекция ProductRepository.
       * Представление теперь получает информацию о продукте напрямую из CartItem, который содержит объект
         Product, что позволяет избежать проблемы N+1.